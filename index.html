<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Be My Valentine ðŸ’–</title>
<style>
  :root{
    --bg1:#ff4d6d;
    --bg2:#ff758f;
    --card-bg:rgba(0,0,0,0.22);
    --white: #fff;
  }
  html,body{
    height:100%;
    margin:0;
    font-family:Arial, Helvetica, sans-serif;
    background: linear-gradient(135deg,var(--bg1),var(--bg2));
    color:var(--white);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }
  .wrap{
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:20px;
    box-sizing:border-box;
  }
  .card{
    width:320px;
    max-width:92vw;
    background:var(--card-bg);
    padding:28px;
    border-radius:18px;
    box-shadow:0 10px 30px rgba(0,0,0,0.3);
    text-align:center;
    position:relative;
    overflow:hidden;
  }
  h1{font-size:26px;margin:0 0 8px}
  p{font-size:15px;margin:0 0 22px;line-height:1.3}
  .controls{
    height:48px;
    position:relative;
  }
  button{
    font-size:15px;
    padding:10px 18px;
    border:0;
    border-radius:28px;
    cursor:pointer;
    color:var(--white);
    background:rgba(255,255,255,0.06);
    transition:transform 220ms ease, box-shadow 150ms ease;
    position:relative;
    z-index:2;
  }
  button:active{ transform:scale(0.98) }
  #yes{
    background:#2ecc71;
    margin-right:10px;
  }
  #no{
    background:#e74c3c;
    position:absolute;
    top:0;
    left:50%;
    transform:translate3d(-50%,0,0);
    will-change:transform;
    touch-action:manipulation;
  }
  /* Success view */
  .success{
    display:none;
    align-items:center;
    justify-content:center;
    flex-direction:column;
    gap:10px;
    padding:20px;
    min-height:200px;
  }
  .show{display:flex}
  /* confetti canvas overlay */
  canvas.confetti{
    position:fixed;
    left:0;top:0;
    width:100vw;height:100vh;
    pointer-events:none;
    z-index:9999;
  }
  /* reduced motion */
  @media (prefers-reduced-motion: reduce){
    *{transition:none!important}
  }
</style>
</head>
<body>
<div class="wrap">
  <main class="card" role="main" aria-labelledby="card-title">
    <section id="card-view" aria-hidden="false">
      <h1 id="card-title">Hej <span id="recipient">Paulina</span> ðŸ’•</h1>
      <p>Prosto z mojego sercaâ€¦<br>Paulina, zostaniesz mojÄ… WalentynkÄ…? ðŸŒ¹</p>

      <div class="controls" aria-hidden="false">
        <button id="yes" aria-label="Tak, zostanÄ™ twojÄ… walentynkÄ…" tabindex="0">Tak ðŸ’–</button>
        <button id="no" aria-label="Nie, nie chcÄ™" tabindex="0">Nie ðŸ˜…</button>
      </div>

      <div aria-live="polite" id="announcer" style="position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden"></div>
    </section>

    <section id="success-view" class="success" aria-hidden="true" role="status">
      <h1 id="success-title"></h1>
      <p id="success-text"></p>
    </section>
  </main>
</div>

<!-- canvas for confetti -->
<canvas class="confetti" id="confetti" aria-hidden="true"></canvas>

<script>
/* Utility: get name from query ?name=... or default */
function getName(){
  try{
    const p = new URLSearchParams(window.location.search);
    const n = p.get('name');
    if(n && n.trim()) return n.trim();
  }catch(e){}
  return "Paulina";
}

/* DOM refs */
const name = getName();
const recipientEl = document.getElementById('recipient');
recipientEl.textContent = name;
document.querySelector('#card-view p').innerHTML = `Prosto z mojego sercaâ€¦<br>${name}, zostaniesz mojÄ… WalentynkÄ…? ðŸŒ¹`;

const yesBtn = document.getElementById('yes');
const noBtn = document.getElementById('no');
const card = document.querySelector('.card');
const announcer = document.getElementById('announcer');
const successView = document.getElementById('success-view');
const successTitle = document.getElementById('success-title');
const successText = document.getElementById('success-text');
const confettiCanvas = document.getElementById('confetti');

/* Accessibility: keyboard shortcuts */
yesBtn.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter' || e.key === ' '){
    e.preventDefault();
    sayYes();
  }
});
noBtn.addEventListener('keydown', (e)=>{
  // if user tabs to No and presses Enter/Space, nudge it away
  if(e.key === 'Enter' || e.key === ' '){
    e.preventDefault();
    moveNo();
  }
});

/* Say yes: switch to success view + confetti */
function sayYes(){
  // announce
  announcer.textContent = `${name} wybraÅ‚a TAK â€” sukces!`;
  // show success view
  successTitle.textContent = `YAYYYY ${name} ðŸ’˜ðŸŽ‰`;
  successText.textContent = `${name}, wÅ‚aÅ›nie zrobiÅ‚aÅ› mnie najszczÄ™Å›liwszÄ… osobÄ… na Å›wiecie ðŸ¥¹â¤ï¸`;
document.getElementById('card-view').setAttribute('aria-hidden','true');
successView.setAttribute('aria-hidden','false');
successView.classList.add('show');
  // start confetti unless user prefers reduced motion
  const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
  if(!mq.matches){
    launchConfetti();
  }
}

/* Move NO button within card bounds using translate3d (better performance) */
function moveNo(){
  const cardRect = card.getBoundingClientRect();
  const btnRect = noBtn.getBoundingClientRect();

  // padding inside card to keep button away from edges
  const pad = 8;

  const maxX = cardRect.width - btnRect.width - pad*2;
  const maxY = cardRect.height - btnRect.height - pad*2;

  // if card smaller than button, keep centered
  const randX = maxX > 0 ? (Math.random() * maxX) + pad : (cardRect.width - btnRect.width)/2;
  const randY = maxY > 0 ? (Math.random() * maxY) + pad : 0;

  // compute translate relative to initial positioned center:
  // initial left is 50% with transform(-50%,0) â€” compute final translate accordingly
  const initialX = (cardRect.width/2) - (btnRect.width/2);
  const dx = randX - initialX;
  const dy = randY - btnRect.top + (btnRect.top - cardRect.top);

  // Apply transform with translate3d
  noBtn.style.transform = `translate3d(${dx}px, ${randY}px, 0)`;

  // small aria announcement to screen readers
  announcer.textContent = `Przycisk "Nie" siÄ™ przesunÄ…Å‚.`;
}

/* Event bindings: pointerenter, touchstart and focus */
noBtn.addEventListener('pointerenter', (e)=>{
  // if pointer is a mouse or touch, move away
  moveNo();
});
noBtn.addEventListener('touchstart', (e)=>{
  // prevent default to avoid immediate click
  e.preventDefault();
  moveNo();
}, {passive:false});
// if button receives focus (keyboard), move it (funny behavior)
noBtn.addEventListener('focus', ()=>{
  setTimeout(moveNo, 150);
});

// also allow yes click
yesBtn.addEventListener('click', sayYes);

/* Basic confetti: small particle system on canvas */
function launchConfetti(){
  const canvas = confettiCanvas;
  const ctx = canvas.getContext('2d');
  let width = canvas.width = innerWidth;
  let height = canvas.height = innerHeight;
  window.addEventListener('resize', ()=>{ width = canvas.width = innerWidth; height = canvas.height = innerHeight; });

  const colors = ['#ffdd57','#ff6b6b','#7bed9f','#ffffff','#ffd1dc'];
  const particles = [];
  const total = 80;

  for(let i=0;i<total;i++){ 
    particles.push({
      x: Math.random()*width,
      y: Math.random()*-height*0.4,
      vx: (Math.random()-0.5)*3,
      vy: Math.random()*3+2,
      size: Math.random()*8+4,
      rot: Math.random()*360,
      vr: (Math.random()-0.5)*8,
      color: colors[Math.floor(Math.random()*colors.length)],
      ttl: 200 + Math.random()*100
    });
  }

  let t = 0;
  function draw(){
    ctx.clearRect(0,0,width,height);
    for(let p of particles){
      p.x += p.vx;
      p.y += p.vy;
      p.vy += 0.04; // gravity
      p.rot += p.vr;
      p.ttl--;
      ctx.save();
      ctx.translate(p.x,p.y);
      ctx.rotate(p.rot * Math.PI/180);
      ctx.fillStyle = p.color;
      ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size*0.6);
      ctx.restore();
    }
    // remove dead
    for(let i=particles.length-1;i>=0;i--){
      if(particles[i].ttl<=0 || particles[i].y>height+50) particles.splice(i,1);
    }
    if(particles.length>0){
      t = requestAnimationFrame(draw);
    } else {
      ctx.clearRect(0,0,width,height);
      canvas.style.display = 'none';
      cancelAnimationFrame(t);
    }
  }

  canvas.style.display = 'block';
  draw();
}

/* Small enhancement: keep NO button near initial position on load */
(function init(){
  // reset transform so initial measurements are accurate
  noBtn.style.transform = 'translate3d(-50%,0,0)';
  // set role/labels
  yesBtn.setAttribute('role','button');
  noBtn.setAttribute('role','button');
})();
</script>
</body>
</html>